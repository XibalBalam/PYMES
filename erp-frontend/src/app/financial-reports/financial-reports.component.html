<h2>Reportes Financieros</h2>
<form class="filters" (ngSubmit)="$event.preventDefault()">
  <mat-form-field appearance="outline">
    <mat-label>AÃ±o</mat-label>
    <input matInput type="number" [(ngModel)]="year" name="year" min="2000" max="2100">
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Mes</mat-label>
    <input matInput type="number" [(ngModel)]="month" name="month" min="1" max="12">
  </mat-form-field>
</form>
<div class="reports-menu">
  <button mat-raised-button color="primary" (click)="selectReport('balance')">Balance General</button>
  <button mat-raised-button color="primary" (click)="selectReport('resultados')">Estado de Resultados</button>
  <button mat-raised-button color="primary" (click)="selectReport('mayor')">Libro Mayor</button>
  <button mat-raised-button color="primary" (click)="selectReport('diario')">Libro Diario</button>
  <button mat-raised-button color="primary" (click)="selectReport('auxiliares')">Auxiliares</button>
</div>
<div class="report-content">
  <ng-container *ngIf="loading">Cargando...</ng-container>
  <ng-container *ngIf="!loading && reportData">
    <div class="export-buttons" *ngIf="reportData.data && reportData.data.length">
      <button mat-stroked-button color="primary" (click)="exportToExcel()">Exportar a Excel</button>
      <button mat-stroked-button color="accent" (click)="exportToPDF()">Exportar a PDF</button>
    </div>
    <div class="chart-container" *ngIf="chartData">
      <canvas baseChart
        [data]="chartData"
        [type]="chartType"
        [legend]="true">
      </canvas>
    </div>
    <ng-container *ngIf="reportData.error">
      <div class="error">{{ reportData.error }}</div>
    </ng-container>
    <ng-container *ngIf="!reportData.error && reportData && reportData.data && reportData.data.length">
      <table mat-table [dataSource]="reportData.data" class="mat-elevation-z1">
        <ng-container *ngFor="let col of getColumns(reportData.data)" [matColumnDef]="col">
          <th mat-header-cell *matHeaderCellDef>{{ col }}</th>
          <td mat-cell *matCellDef="let element">{{ element[col] }}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="getColumns(reportData.data)"></tr>
        <tr mat-row *matRowDef="let row; columns: getColumns(reportData.data);"></tr>
      </table>
    </ng-container>
    <ng-container *ngIf="!reportData.error && (!reportData.data || !reportData.data.length)">
      <pre>{{ reportData | json }}</pre>
    </ng-container>
  </ng-container>
</div>
